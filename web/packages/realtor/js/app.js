var Featured=function(){var e=this;e.photoNodesLft={},e.photoNodesRt={},e.photoLftActive={},e.photoRtActive={},e.internalRotTimeouts={},this.populateFeaturedProperties=function(){var i=$("#featuredInitial").html();Mustache.parse(i);var n=$("#featuredList").html();Mustache.parse(n),$.post("/search/featured",function(o){if(1==o.code)if(o.properties.length>0){if(o.properties.length>1){var a=o.properties.splice(2,1)[0],s=Mustache.render(i,a);$("#featuredCarousel").html(s),$("div.featured-round").css("visibility","visible"),e.initArrows(),setTimeout(function(){var i=Mustache.render(n,o);$("#completeList").html(i),e.adjustPropertyWidth(),e.rearrangePropertyElements(),t(0),e.startCarousel()},2e3)}$("section.nav-blocks div.featured-round").css("display","block")}else $("#featuredCarousel").html("")},"json")},this.initResizeEvent=function(){!function(){var e=function(e,t,i){var i=i||window,n=!1,o=function(){n||(n=!0,requestAnimationFrame(function(){i.dispatchEvent(new CustomEvent(t)),n=!1}))};i.addEventListener(e,o)};e("resize","optimizedResize")}(),window.addEventListener("optimizedResize",function(){e.adjustPropertyWidth()})},this.initArrows=function(){$("div.bottom .indicators div").on("click",function(){$(this).hasClass("go-back")?s():a()})},this.adjustPropertyWidth=function(){var e=$("body").width()+"px";$("div.property:not(.first)").width(e),$("div.property:not(.first)").css("top","0")},this.rearrangePropertyElements=function(){$properties=$("div#completeList div.property"),$("#featuredCarousel").append($properties),$("div#completeList").remove()},this.startCarousel=function(){e.nodes=$("#featuredCarousel .property"),e.indexActive=0;var t=6e3;!function i(e){setTimeout(function(){a(),i(e)},t)}(3e3)};var t=function(t){e.photoNodesLft[t]=$($("#featuredCarousel .property")[t]).find("#carouselRight .left .sub-image"),e.photoNodesRt[t]=$($("#featuredCarousel .property")[t]).find("#carouselRight .right .sub-image"),e.photoLftActive[t]=0,e.photoRtActive[t]=0;var i=4e3;!function n(){e.internalRotTimeouts[t]=setTimeout(function(){o(t),n()},i)}()},i=function(t){clearTimeout(e.internalRotTimeouts[t])},n=function(i){var n=i,o=e.nodes[e.indexActive],a=e.nodes[n],s=2;TweenLite.to(o,s,{autoAlpha:0}),TweenLite.to(a,s,{autoAlpha:1}),e.indexActive=n,t(n)},o=function(t){e.currentNodeLft=e.photoNodesLft[t][e.photoLftActive[t]],e.currentNodeRt=e.photoNodesRt[t][e.photoRtActive[t]],e.nextNodeLft=e.photoNodesLft[t][e.photoLftActive[t]===e.photoNodesLft[t].length-1?0:e.photoLftActive[t]+1],e.nextNodeRt=e.photoNodesRt[t][e.photoRtActive[t]===e.photoNodesRt[t].length-1?0:e.photoRtActive[t]+1];var i=1,n=$(e.currentNodeLft).width();TweenLite.to(e.currentNodeLft,i,{x:n}),TweenLite.to(e.currentNodeRt,i,{x:n,delay:1}),TweenLite.fromTo(e.nextNodeLft,i,{x:-n,autoAlpha:1},{x:0,autoAlpha:1}),TweenLite.fromTo(e.nextNodeRt,i,{x:-n,opacity:1,delay:1},{x:0,opacity:1,delay:1}),e.photoLftActive[t]=e.photoLftActive[t]===e.photoNodesLft[t].length-1?0:e.photoLftActive[t]+1,e.photoRtActive[t]=e.photoRtActive[t]===e.photoNodesRt[t].length-1?0:e.photoRtActive[t]+1},a=function(){i(e.indexActive);var t=e.indexActive===e.nodes.length-1?0:e.indexActive+1;n(t)},s=function(){i(e.indexActive),n(0===e.indexActive?nodeCount:e.indexActive-1)};this.onloadFunc=function(){$("#featuredCarousel")&&$("#featuredCarousel").length>0&&(this.populateFeaturedProperties(),this.initResizeEvent())}},Header=function(){var e=this;this.initShrink=function(){if($("body").hasClass("pg-home")){var e=$("header"),t=$("header ul.social.free-standing");$(window).scrollTop()>50&&e.addClass("shrink"),$(window).scroll(function(){$(window).scrollTop()>50?(TweenLite.to(e,.5,{className:"shrink"}),TweenLite.to(t,.5,{autoAlpha:0})):(TweenLite.to(e,.5,{className:"-=shrink"}),TweenLite.to(t,.5,{autoAlpha:1}))})}},this.initMobileNav=function(){var e=$("[slideable]"),t=$("div#mobileNav");$("body").append(t);var i=$("div.trigger a"),n=$("div.trigger");i.on("click",function(){var t=$("div#mobileNav");t.hasClass("open")?(TweenLite.to(t,.5,{className:"-=open"}),TweenLite.to(n,.6,{width:"75px"}),TweenLite.to(e,.5,{className:"-=open"})):(TweenLite.to(t,.5,{className:"+=open"}),TweenLite.to(n,.45,{width:"100%"}),TweenLite.to(e,.5,{className:"+=open"}))});var o=$("div#mobileNav ul.sidebar li.has-subs");o.on("click",function(){var e=$(this).next("ul.sub"),t=e.children("li");e.hasClass("open")?($(this).addClass("show-plus"),e.removeClass("open"),TweenLite.to(e,.5,{height:0})):($(this).removeClass("show-plus"),e.addClass("open"),TweenLite.to(e,.5,{height:75*t.length}))})},this.initSubnavIndicators=function(){var e=$("nav ul.majority > li.has-subs > a");e.each(function(e,t){$(t).append("<i class='icon-arrow-down'></i>")})},this.initSubNavAction=function(){$("nav ul.majority > li.sub").each(function(e,t){if("sub-contact"!=$(t).attr("id")){var i=$(t).children("ul").children("li");$(t).children("ul").css("width",180*i.length+22)}});var t=$("nav ul.majority > li.has-subs"),i=$("nav ul.majority > li.sub");t.on("mouseenter tap",function(t){t.preventDefault(),e.navTimer&&clearTimeout(e.navTimer);var i=$(this),n=i.attr("data-sub"),o=$("ul.majority li#sub-"+n),a=$("ul.majority li.sub.open");if(o.hasClass("open"))"tap"===t.type&&o.hasClass("open")&&(i.addClass("noHover"),TweenLite.to(o,.2,{autoAlpha:0,className:"-=open"}));else{var s=o.children("ul"),r=o.children("ul").children("li"),c=180*(r.length/2)*-1;s.css("right",c),TweenLite.to(a,.2,{autoAlpha:0,className:"-=open",onComplete:function(){TweenLite.to(o,.2,{autoAlpha:1,className:"+=open"})}});var l=s[0].getBoundingClientRect();if(l.right>window.innerWidth){var d=Math.round(l.right-(window.innerWidth||document.documentElement.clientWidth))+5,u="tap"===t.type?0:.1;TweenLite.to(s,u,{x:-d})}s.on("mouseleave",function(){e.navTimer&&clearTimeout(e.navTimer),e.navTimer=setTimeout(function(){TweenLite.to(o,.2,{autoAlpha:0,className:"-=open"})},500)}),s.on("mouseenter",function(){e.navTimer&&clearTimeout(e.navTimer)}),"tap"===t.type&&i.removeClass("noHover")}}),t.on("mouseleave",function(){e.navTimer&&clearTimeout(e.navTimer),e.navTimer=setTimeout(function(){TweenLite.to(i,.2,{autoAlpha:0,className:"-=open"})},500)}),t.on("click",function(e){e.preventDefault()})},this.onloadFunc=function(){this.initSubNavAction(),this.initSubnavIndicators(),this.initMobileNav(),this.initShrink()}},Home=function(){this.initBlockLinks=function(){var e=this;e.transitionSpeed=.8,e.timeLines=[],$(".nav-blocks div.row > div").on("click",function(){window.location.href=$(this).attr("data-url")})},this.initLayoutAndLookdown=function(){if(0!==$("body.pg-home").length){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=e-100;$("div.look-down").css("top",t+"px"),$("body.pg-home section.hero").css("height",e+"px"),$("body.pg-home section.hero .masthead .node").css("height",e+"px"),$("div.look-down").on("click",function(){var e=$("section.featured").position().top;TweenLite.to(window,1,{scrollTo:{y:e,x:0},ease:Power2.easeOut})})}},this.onloadFunc=function(){this.initBlockLinks(),this.initLayoutAndLookdown()}},Landing=function(){_self=this,_self._postsPerPage=8,this.populateSubPageList=function(){var e=$("#pageList").html(),t=$("#pagination").html();Mustache.parse(e),Mustache.parse(t);var i=window.location.pathname.split("/").length>=3?"single":"multi";$.post("/landing/list/"+CCM_CID+"/"+i,function(i){if(1==i.code){var n={};if(i.pages.length>_self._postsPerPage){for(var o=[],a=[],s=1,r=1;i.pages.length;)o.push(i.pages.splice(0,_self._postsPerPage)),a.push(s++);n.increments=a,n.pages=o[r-1]}else n.pages=i.pages,n.increments=null;var c=Mustache.render(e,n),l=Mustache.render(t,n);$("section.subnav div.pagelist").html(c),$("section.subnav div.pagelist").css("opacity",1),$("section.subnav div.pagination").html(l),$("section.subnav div.pagination ul li:nth-of-type(2)").addClass("active"),$("section.subnav div.pagination ul li:not(:first-of-type)").on("click",function(){var t=$("section.subnav div.pagelist");$("section.subnav div.pagelist").css("opacity",0);var i=$(this).attr("data-next-page")-1;n.pages=o[i];var a=Mustache.render(e,n);TweenLite.to(t,1,{opacity:0,onComplete:function(){t.html(a),t.css("opacity",1)}}),$("section.subnav div.pagination ul li").removeClass("active"),$("section.subnav div.pagination ul li:nth-of-type("+(i+2)+")").addClass("active")})}},"json")},this.onloadFunc=function(){$("body.pg-landing section.subnav")&&$("body.pg-landing section.subnav").length>0&&this.populateSubPageList()}},Masthead=function(){var e=this;this.startCarousel=function(){e.circles=$(".circles a"),e.circles.on("click",function(){var e=Array.prototype.slice.call($(".circles a")).indexOf(this);t(e)}),e.carousel=$("section.hero div.masthead"),e.nodes=$("section.hero div.masthead div.node"),e.indexActive=0,e.loopTiming=1e3*e.carousel.attr("data-loop-timing")||0,0!=e.loopTiming&&!function n(t){setTimeout(function(){i(),n(t)},e.loopTiming)}(3e3)};var t=function(t){var i=t,n=e.nodes[e.indexActive],o=$(".top",n).children(),a=e.nodes[i],s=$(".top",a).children();transitionSpeed=2,TweenLite.to(n,transitionSpeed,{autoAlpha:0}),TweenMax.staggerTo(o,transitionSpeed,{x:200,autoAlpha:0},transitionSpeed/o.length),TweenMax.staggerFromTo(s,transitionSpeed,{x:-200,autoAlpha:0},{x:0,autoAlpha:1},transitionSpeed/s.length),TweenLite.to(a,transitionSpeed,{autoAlpha:1}),e.indexActive=i,e.circles.removeClass("active").eq(e.indexActive).addClass("active")},i=function(){t(e.indexActive===e.nodes.length-1?0:e.indexActive+1)},n=function(){t(0===e.indexActive?e.nodes.length:e.indexActive-1)};this.initArrows=function(){$("section.hero div.masthead a.edit-arrows").on("click",function(){$(this).hasClass("icon-arrow-left")?n():i()})},this.onloadFunc=function(){$("section.hero div.masthead")&&$("section.hero div.masthead").length>0&&(this.startCarousel(),this.initArrows())}},Modals=function(){function e(e){var t=1==e.code?"success alert-success alert-info ":"error alert-danger";output=$('<div class="alert message alert-message info '+t+'"><ul></ul></div>');var i="";return $.each(e.messages,function(e,t){i+="<li>"+t+"</li>"}),output.find("ul").append(i),output}var t=this;this.openModal=function(e){$("#modalBox").remove(),$("body").append('<div id="modalBox" class="modal hide fade"><div class="modal-content"><div class="modal-header clearfix"><a class="close" data-dismiss="modal">Ã—</a><h3 class="title-target"></h3></div><div id="spinner"><span class="icon-spinner spinner spinner--steps"></span></div><div class="loadTarget"></div></div></div>'),$("div#spinner").css("display","inline-block");var i=$("#modalBox");i.css({width:e.width,margin:20}).modal(),$("h3.title-target",i).empty().text(e.title),$("div.loadTarget",i).empty().load("/modal"+e.url,e.data,function(e,i){"success"===i&&($("div#spinner").css("display","none"),t.initFormAjaxing())}),i.removeClass("hide")},this.initModalTriggers=function(){$(".modalize").on("click",function(e){e.preventDefault();var i=$(this);t.openModal({width:i.attr("data-width"),title:i.attr("data-title"),url:i.attr("data-load"),data:{entityID:i.attr("data-entity-id")||null}})})},this.initFormAjaxing=function(){$('form[data-method="json"], form#contact-form').on("submit",function(t){t.preventDefault();var i=$(t.target),n=+i.attr("data-close-modal-delay"),o=i.attr("data-cancel-success-alert"),a=i.attr("action"),s=i.serializeArray();s.push({name:"resp_method",value:"json"}),$(".message",i).remove(),$("div.control-group.error",i).removeClass("error"),$.post(a,s,function(t){if("true"!=o||1!=t.code){var a=$(".modal-body",i);0!==a.length?a.prepend(e(t)):i.prepend(e(t)),"object"==typeof t.fields&&$.each(t.fields,function(e,t){$('[name="'+t+'"]',i).parents("div.control-group").addClass("error")})}n>0&&1==t.code&&setTimeout(function(){$("#modalBox").modal("hide")},n),i.trigger("ajax_form_complete",t)},"json")})},this.onloadFunc=function(){this.initModalTriggers()}},Property=function(){var e,t,i,n,o,a,s=this;s.indexActive=0,this.initCarousel=function(){a=$(".circles a"),a.on("click",function(){var e=Array.prototype.slice.call($(".circles a")).indexOf(this);r(e)}),o=$(".markers.thumbs a"),o.on("click",function(){var e=Array.prototype.slice.call($(".markers.thumbs a")).indexOf(this);r(e)}),s.indexActive=0,s.nodes=$("#gallery .masthead .node");var e=5e3;!function t(i){setTimeout(function(){c(),t(i)},e)}(7e3)};var r=function(e){var t=e,i=s.nodes[s.indexActive],n=s.nodes[t],r=2;TweenLite.to(i,r,{autoAlpha:0}),TweenLite.to(n,r,{autoAlpha:1}),s.indexActive=t,a.removeClass("active").eq(s.indexActive).addClass("active"),o.removeClass("active").eq(s.indexActive).addClass("active")},c=function(){r(s.indexActive===s.nodes.length-1?0:s.indexActive+1)};this.initToggleGalleryThumbs=function(){e=$(".pg-properties section#gallery div.markers.thumbs"),t=$(".pg-properties section#gallery div#showhide"),i=$(".pg-properties section#gallery a.arrow.left"),n=$(".pg-properties section#gallery a.arrow.right"),t.on("click",function(){t.hasClass("up")?(TweenLite.to(t,.35,{className:"-=up"}),TweenLite.to(e,.25,{className:"+=hidden"}),TweenLite.to(i,.25,{opacity:0}),TweenLite.to(n,.25,{opacity:0})):(TweenLite.to(t,.35,{className:"up"}),TweenLite.to(e,.25,{className:"-=hidden"}),TweenLite.to(i,.25,{opacity:1}),TweenLite.to(n,.25,{opacity:1}))})},this.initSlideThumbs=function(){i=$(".pg-properties section#gallery a.arrow.left"),n=$(".pg-properties section#gallery a.arrow.right"),i.on("click",function(){TweenLite.to(e,.25,{left:"-=77"})}),n.on("click",function(){parseInt(e.css("left").replace("px",""))<0&&TweenLite.to(e,.25,{left:"+=77"})})},this.initSortingDropdown=function(){var e=$("section.pagination div.sorter");e.on("click",function(){var t=$(this).parents("div.sortby"),i=t.find("div.sortbyList"),n={},o="100%"==t.css("width")?{right:0}:{left:"12px"};$(this)[0]==e[0]?($("section.results").append(i),n={top:0}):($("section.footer").append(i),n={top:-50}),"visible"==i.css("visibility")?i.css({visibility:"hidden"}):(i.css($.extend({visibility:"visible"},o)),i.css(n))})},this.showRelatedProperties=function(){var e=$("#relatedList").html();Mustache.parse(e);var t="/search/related/"+PROP_CITY+"/"+PROP_TYPE+"/"+PROP_PRICE+"/"+PROP_ID;$.post(t,function(t){if(t.code&&1==t.code)if(t.properties.length>=3){var i=Mustache.render(e,t);$("#relatedListings").html(i),$(".featured-round").css("display","block")}else $("#relatedListings").html("");else $("#relatedListings").html("")},"json")},this.onloadFunc=function(){0!=$(".pg-properties section#gallery div#showhide").length&&(this.initToggleGalleryThumbs(),this.initSlideThumbs(),this.initCarousel()),0!=$("section.pagination div.sortby").length&&this.initSortingDropdown(),$("section.related div#relatedListings")&&0!=$("section.related div#relatedListings").length&&this.showRelatedProperties(),$("body.pg-properties section.subnav")&&$("body.pg-properties section.subnav").length>0&&this.initSubPageList()},this.autoInit=void 0},Regions=function(){var e=this;this.startCarousel=function(){e.carousel=$("section.sub-areas div.masthead"),e.nodes=$("section.sub-areas div.masthead div.node"),e.indexActive=0,e.loopTiming=1e3*e.carousel.attr("data-loop-timing")||0,0!=e.loopTiming&&!function t(n){e.rotationTimeOut=setTimeout(function(){i(),t(n)},e.loopTiming)}(3e3)};var t=function(t){var i=t,n=e.nodes[e.indexActive],o=e.nodes[i],a=1,s=$(n).width();TweenLite.to(n,a,{x:-s}),TweenLite.fromTo(o,a,{x:s,autoAlpha:1},{x:0,autoAlpha:1}),e.indexActive=i},i=function(){t(e.indexActive===e.nodes.length-1?0:e.indexActive+1)};this.initLlinks=function(){$("section.current-level-nav li").on("click",function(){t($(this).index()),clearTimeout(e.rotationTimeOut)})},this.onloadFunc=function(){$("section.sub-areas div.masthead")&&$("section.sub-areas div.masthead").length>0&&(this.startCarousel(),this.initLlinks())}},ResponsiveVideo=function(){this.initVideoResize=function(){var e=$("iframe[src^='https://player.vimeo.com'], iframe[src^='http://player.vimeo.com']");e.each(function(){$(this).data("aspectRatio",this.height/this.width).removeAttr("height").removeAttr("width")}),$(window).resize(function(){e.each(function(){var e=$(this),t=e.parent().width();e.width(t).height(t*e.data("aspectRatio"))})}).resize()},this.onloadFunc=function(){this.initVideoResize()}},Search=function(){{var e=($(document),$(".sortBy"),$("form#propertySearch input, form#propertySearch select"));$("#priceMin"),$("#priceMax"),$("#priceMinDisplay"),$("#priceMaxDisplay"),$(".scrollable"),$("#price-slider")}this.clearFields=function(e){var t=$($(e).attr("data-within")),i=$("input, select",t).not(".unclearable");i.each(function(e,t){var i=$(t);"radio"==i.attr("type")||"checkbox"==i.attr("type")?i[0].checked=!1:i.val("")})},this.toggleLocationFilter=function(e){e.preventDefault();var t=$("#locationFilters");t.hasClass("hidden")?TweenLite.to(t,.25,{className:"-=hidden"}):TweenLite.to(t,.25,{className:"hidden"})},this.closeLocationFilter=function(){var e=$("#locationFilters");TweenLite.to(e,.25,{className:"hidden"})},this.searchOnChange=function(){var t=this;this.getCount=function(e){$.post("/search/count",e,function(e){1==e.code&&$("span.target-result-count").text(e.resultCount)},"json")},e.on("change",function(){var e=$("form#propertySearch").serializeArray();t.getCount(e)}),this.getCount($("form#propertySearch").serializeArray())},this.onloadFunc=function(){$("form#propertySearch").length>0&&(this.searchOnChange(),$("form#propertySearch").on("click",function(e){$(e.target)[0]!=$("button.locations")[0]&&0===$("div#locationFilters").has(e.target).length&&LB.Search.closeLocationFilter()}))}};!function(e){"use strict";e.modules=[];var t=function(t){e[t]=new window[t],e.modules.push(e[t])};t("Header"),t("Search"),t("Featured"),t("Property"),t("Masthead"),t("Landing"),t("Modals"),t("Home"),t("Regions"),t("ResponsiveVideo"),e.init=function(){$(function(){FastClick.attach(document.body)})}}(window.LB=window.LB||{}),LB.init(),window.addEventListener("load",function(){LB.modules.forEach(function(e){e.onloadFunc&&e.onloadFunc()})},!1);